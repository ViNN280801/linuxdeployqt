# linuxdeployqt-python

A Python implementation of linuxdeployqt for deploying Qt applications on Linux.

## Overview

This tool creates self-contained AppDir bundles for Qt applications by automatically detecting Qt installations, analyzing dependencies, and deploying only the required components.

## Features

- ðŸŽ¯ **Smart Qt Detection**: Automatically finds and allows selection from multiple Qt installations
- ðŸ” **Intelligent Component Analysis**: Analyzes application dependencies to determine required Qt components
- ðŸ”Œ **Plugin Deployment**: Automatically deploys required Qt plugins based on used libraries
- ðŸŽ¨ **QML Support**: Analyzes QML files and deploys required QML modules
- ðŸ“ **Custom QML Components**: Supports deployment of user-defined QML components
- âš™ï¸ **AppDir Creation**: Creates proper AppDir structure with qt.conf and AppRun
- ðŸŒ **WebEngine Support**: Special handling for Qt WebEngine applications
- ðŸŒ **Translation Support**: Deploys Qt translations automatically

## Requirements

- Python 3.6+
- Qt development tools (qmake, ldd)
- Target Qt application binary

## Usage

### Basic Usage

```bash
python linuxdeployqt.py --binary-path ./build/MyApp
```

### Advanced Usage

```bash
python linuxdeployqt.py \
    --binary-path ./build/MyApp \
    --output-path ./MyApp.AppDir \
    --qml-dir ./src/qml \
    --verbose 2
```

### Command Line Options

- `--binary-path PATH` (required): Path to the application binary
- `--output-path PATH`: Output directory for AppDir (default: current directory + binary name + .AppDir)
- `--qml-dir PATH`: Path to custom QML components directory (supports ~, ., .. resolution)
- `--verbose LEVEL`: Verbosity level (0=SUCCESS, 1=INFO, 2=DEBUG, default: 1)
- `--version`: Show version information

### Examples

#### Deploy a Simple Qt Application

```bash
python linuxdeployqt.py --binary-path ./build/release/MyQtApp
```

#### Deploy with Custom QML Components

```bash
python linuxdeployqt.py \
    --binary-path ./build/release/MyQmlApp \
    --qml-dir ~/MyProject/qml \
    --output-path ~/Desktop/MyQmlApp.AppDir
```

#### Deploy with Debug Output

```bash
python linuxdeployqt.py \
    --binary-path ./build/MyApp \
    --verbose 2
```

## Qt Version Selection

When multiple Qt installations are detected, the tool will prompt you to select which one to use:

```
Found 3 Qt installation(s)
  1. Qt 5.15.2 (system) - /usr/lib/x86_64-linux-gnu/qt5
  2. Qt 6.4.2 (manual) - /opt/Qt/6.4.2/gcc_64
  3. Qt 6.5.0 (qtcreator) - /home/user/Qt/6.5.0/gcc_64

Select Qt version to use (1-3):
```

## AppDir Structure

The tool creates a standard AppDir structure:

```
MyApp.AppDir/
â”œâ”€â”€ AppRun -> usr/bin/MyApp
â”œâ”€â”€ usr/
â”‚   â”œâ”€â”€ bin/
â”‚   â”‚   â”œâ”€â”€ MyApp
â”‚   â”‚   â””â”€â”€ qt.conf
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ libQt5Core.so.5
â”‚   â”‚   â”œâ”€â”€ libQt5Gui.so.5
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”œâ”€â”€ platforms/
â”‚   â”‚   â”œâ”€â”€ imageformats/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ qml/
â”‚   â”‚   â”œâ”€â”€ QtQuick/
â”‚   â”‚   â”œâ”€â”€ QtQuick.Controls/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ translations/
â”‚       â”œâ”€â”€ qt_en.qm
â”‚       â””â”€â”€ ...
```

## qt.conf Configuration

The tool automatically creates a `qt.conf` file with the correct paths:

```ini
# Generated by linuxdeployqt-python
[Paths]
Prefix = ../
Plugins = plugins
Imports = qml
Qml2Imports = qml
Libraries = lib
Binaries = bin
```

## Supported Qt Modules

The tool automatically detects and deploys components for:

- **Core Libraries**: QtCore, QtGui, QtWidgets, QtNetwork, etc.
- **QML Modules**: QtQuick, QtQuick.Controls, QtWebEngine, etc.
- **Plugins**: platforms, imageformats, iconengines, xcbglintegrations, etc.
- **Special Components**: WebEngine process and resources, translations

## Custom QML Components

Use `--qml-dir` to include your custom QML components:

```bash
python linuxdeployqt.py \
    --binary-path ./build/MyApp \
    --qml-dir ./src/qml
```

The tool will:

1. Analyze your QML files for imports
2. Copy your custom QML components to the AppDir
3. Deploy any Qt modules referenced by your QML files

## Development

### Project Structure

```
linuxdeployqt/
â”œâ”€â”€ linuxdeployqt.py          # Main entry point
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ qt_deployer.py        # Main deployment orchestrator
â”‚   â”œâ”€â”€ qt_version_detector.py # Qt installation detection
â”‚   â”œâ”€â”€ qt_component_analyzer.py # Component analysis
â”‚   â”œâ”€â”€ qml_analyzer.py       # QML import analysis
â”‚   â””â”€â”€ ldd_dependency_collector.py # Library dependency collection
â””â”€â”€ logger/
    â””â”€â”€ logger.py             # Logging utilities
```

### Adding New Features

1. **New Qt Module Support**: Update `qt_component_analyzer.py`
2. **New Plugin Types**: Extend the plugin detection logic
3. **Custom Analysis**: Modify the analyzer classes

## Comparison with Original linuxdeployqt

| Feature          | Original         | Python Version          |
| ---------------- | ---------------- | ----------------------- |
| Qt Detection     | Manual qmake     | Automatic multi-version |
| Plugin Selection | Rule-based       | Dependency-driven       |
| QML Analysis     | qmlimportscanner | Built-in parser         |
| Custom QML       | Basic            | Advanced support        |
| User Interaction | Limited          | Interactive selection   |
| Cross-platform   | Linux only       | Linux primary           |

## Troubleshooting

### Common Issues

1. **No Qt installations found**

   - Ensure Qt is installed and qmake is in PATH
   - Check that Qt development packages are installed

2. **Missing libraries**

   - Verify the binary runs on the system before deployment
   - Check LD_LIBRARY_PATH includes Qt libraries

3. **QML modules not found**
   - Ensure QML modules are properly installed
   - Check that the QML import paths are correct

### Debug Mode

Use `--verbose 2` for detailed debug output:

```bash
python linuxdeployqt.py --binary-path ./MyApp --verbose 2
```

## License

This project is licensed under the same terms as the original linuxdeployqt (GPL v3).

## Contributing

Contributions are welcome! Please feel free to submit pull requests or open issues for bugs and feature requests.
